{"ast":null,"code":"var _jsxFileName = \"d:\\\\map for cur\\\\toilet-finder-kaliningrad\\\\frontend\\\\src\\\\components\\\\MapPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport { Button, Alert, Card, Badge } from 'react-bootstrap';\nimport { toiletAPI } from '../services/api';\nimport L from 'leaflet';\nimport Legend from './Legend';\nimport AddToiletModal from './AddToiletModal';\n\n// Fix for default marker icons\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'\n});\n\n// Оптимизированные иконки с кэшированием\nconst iconCache = new Map();\nconst createCustomIcon = type => {\n  if (iconCache.has(type)) {\n    return iconCache.get(type);\n  }\n  const iconConfig = {\n    free: {\n      color: '#28a745'\n    },\n    paid: {\n      color: '#dc3545'\n    },\n    purchase_required: {\n      color: '#ffc107'\n    }\n  };\n  const config = iconConfig[type];\n  const icon = L.divIcon({\n    html: `<div style=\"background-color: ${config.color}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);\"></div>`,\n    className: 'custom-toilet-marker',\n    iconSize: [20, 20],\n    iconAnchor: [10, 10],\n    popupAnchor: [0, -10]\n  });\n  iconCache.set(type, icon);\n  return icon;\n};\n\n// Kaliningrad center coordinates\nconst KALININGRAD_CENTER = [54.710, 20.511];\nconst MapPage = () => {\n  _s();\n  const [toilets, setToilets] = useState([]);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [userLocation, setUserLocation] = useState(null);\n  const [locationLoading, setLocationLoading] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [alert, setAlert] = useState({\n    show: false,\n    message: '',\n    variant: 'success'\n  });\n  useEffect(() => {\n    loadToilets();\n    getUserLocation();\n  }, []);\n  const getUserLocation = useCallback(() => {\n    if ('geolocation' in navigator) {\n      setLocationLoading(true);\n\n      // Устанавливаем таймаут для геолокации\n      const timeoutId = setTimeout(() => {\n        setLocationLoading(false);\n        setAlert({\n          show: true,\n          message: 'Не удалось определить местоположение. Проверьте настройки геолокации.',\n          variant: 'warning'\n        });\n      }, 10000); // 10 секунд\n\n      navigator.geolocation.getCurrentPosition(position => {\n        clearTimeout(timeoutId);\n        const {\n          latitude,\n          longitude\n        } = position.coords;\n        setUserLocation([latitude, longitude]);\n        setLocationLoading(false);\n      }, error => {\n        clearTimeout(timeoutId);\n        console.error('Error getting location:', error);\n        setLocationLoading(false);\n        let message = 'Не удалось определить местоположение';\n        switch (error.code) {\n          case error.PERMISSION_DENIED:\n            message = 'Доступ к геолокации запрещен';\n            break;\n          case error.POSITION_UNAVAILABLE:\n            message = 'Информация о местоположении недоступна';\n            break;\n          case error.TIMEOUT:\n            message = 'Время ожидания геолокации истекло';\n            break;\n        }\n        setAlert({\n          show: true,\n          message,\n          variant: 'warning'\n        });\n      }, {\n        enableHighAccuracy: true,\n        timeout: 8000,\n        maximumAge: 300000 // 5 минут кэша геолокации\n      });\n    }\n  }, []);\n  const loadToilets = useCallback(async () => {\n    try {\n      const response = await toiletAPI.getAll();\n      // Обрабатываем новый формат ответа с пагинацией\n      const data = Array.isArray(response) ? response : response.data || [];\n      setToilets(data);\n    } catch (error) {\n      console.error('Error loading toilets:', error);\n      setAlert({\n        show: true,\n        message: 'Ошибка загрузки данных',\n        variant: 'danger'\n      });\n    }\n  }, []);\n  const handleAddToilet = useCallback(async data => {\n    setLoading(true);\n    try {\n      await toiletAPI.submit(data);\n      setAlert({\n        show: true,\n        message: 'Точка отправлена на модерацию',\n        variant: 'success'\n      });\n      setShowAddModal(false);\n      // Перезагружаем данные после добавления\n      await loadToilets();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      setAlert({\n        show: true,\n        message: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Ошибка отправки',\n        variant: 'danger'\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [loadToilets]);\n\n  // Оптимизированные функции с мемоизацией\n  const getTypeLabel = useCallback(type => {\n    const labels = {\n      free: 'Бесплатный',\n      paid: 'Платный',\n      purchase_required: 'Только за покупку'\n    };\n    return labels[type];\n  }, []);\n  const getTypeBadgeVariant = useCallback(type => {\n    const variants = {\n      free: 'success',\n      paid: 'danger',\n      purchase_required: 'warning'\n    };\n    return variants[type];\n  }, []);\n\n  // Мемоизированные маркеры для оптимизации рендеринга\n  const toiletMarkers = useMemo(() => {\n    return toilets.map(toilet => /*#__PURE__*/_jsxDEV(Marker, {\n      position: [toilet.latitude, toilet.longitude],\n      icon: createCustomIcon(toilet.type),\n      children: /*#__PURE__*/_jsxDEV(Popup, {\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"border-0\",\n          style: {\n            width: '250px'\n          },\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n              className: \"h6\",\n              children: toilet.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Card.Text, {\n              className: \"small text-muted mb-2\",\n              children: [\"\\uD83D\\uDCCD \", toilet.address]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Badge, {\n              bg: getTypeBadgeVariant(toilet.type),\n              className: \"mb-2\",\n              children: getTypeLabel(toilet.type)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this), toilet.price && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"small mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 19\n              }, this), \" \", toilet.price]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 17\n            }, this), toilet.description && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"small text-muted\",\n              children: toilet.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this)\n    }, toilet.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this));\n  }, [toilets, getTypeLabel, getTypeBadgeVariant]);\n\n  // Мемоизированный маркер пользователя\n  const userLocationMarker = useMemo(() => {\n    if (!userLocation) return null;\n    return /*#__PURE__*/_jsxDEV(Marker, {\n      position: userLocation,\n      icon: L.divIcon({\n        html: '<div style=\"background-color: #007bff; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);\"></div>',\n        className: 'user-location-marker',\n        iconSize: [20, 20],\n        iconAnchor: [10, 10],\n        popupAnchor: [0, -10]\n      }),\n      children: /*#__PURE__*/_jsxDEV(Popup, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center\",\n          children: /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"\\u0412\\u0430\\u0448\\u0435 \\u043C\\u0435\\u0441\\u0442\\u043E\\u043F\\u043E\\u043B\\u043E\\u0436\\u0435\\u043D\\u0438\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this);\n  }, [userLocation]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid p-0\",\n    children: [alert.show && /*#__PURE__*/_jsxDEV(Alert, {\n      variant: alert.variant,\n      onClose: () => setAlert(prev => ({\n        ...prev,\n        show: false\n      })),\n      dismissible: true,\n      className: \"m-3\",\n      children: alert.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-between align-items-center p-3 bg-light\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"h3 mb-0\",\n        children: \"\\u041A\\u0430\\u0440\\u0442\\u0430 \\u0442\\u043E\\u0447\\u0435\\u043A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline-secondary\",\n          onClick: getUserLocation,\n          disabled: locationLoading,\n          className: \"me-2\",\n          children: locationLoading ? '📍...' : '📍 Мое местоположение'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: () => setShowAddModal(true),\n          children: \"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u043E\\u0447\\u043A\\u0443\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Legend, {\n      userLocationExists: !!userLocation\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: 'calc(100vh - 200px)'\n      },\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: KALININGRAD_CENTER,\n        zoom: 12,\n        style: {\n          height: '100%',\n          width: '100%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), userLocationMarker, toiletMarkers]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AddToiletModal, {\n      show: showAddModal,\n      onHide: () => setShowAddModal(false),\n      onSubmit: handleAddToilet,\n      loading: loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 239,\n    columnNumber: 5\n  }, this);\n};\n_s(MapPage, \"7/86Bnppk7F6dkFWS5zN9W7nB7A=\");\n_c = MapPage;\nexport default MapPage;\nvar _c;\n$RefreshReg$(_c, \"MapPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","MapContainer","TileLayer","Marker","Popup","Button","Alert","Card","Badge","toiletAPI","L","Legend","AddToiletModal","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","iconCache","Map","createCustomIcon","type","has","get","iconConfig","free","color","paid","purchase_required","config","icon","divIcon","html","className","iconSize","iconAnchor","popupAnchor","set","KALININGRAD_CENTER","MapPage","_s","toilets","setToilets","showAddModal","setShowAddModal","userLocation","setUserLocation","locationLoading","setLocationLoading","loading","setLoading","alert","setAlert","show","message","variant","loadToilets","getUserLocation","navigator","timeoutId","setTimeout","geolocation","getCurrentPosition","position","clearTimeout","latitude","longitude","coords","error","console","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","enableHighAccuracy","timeout","maximumAge","response","getAll","data","Array","isArray","handleAddToilet","submit","_error$response","_error$response$data","getTypeLabel","labels","getTypeBadgeVariant","variants","toiletMarkers","map","toilet","children","style","width","Body","Title","name","fileName","_jsxFileName","lineNumber","columnNumber","Text","address","bg","price","description","id","userLocationMarker","onClose","prev","dismissible","onClick","disabled","userLocationExists","height","center","zoom","attribution","url","onHide","onSubmit","_c","$RefreshReg$"],"sources":["d:/map for cur/toilet-finder-kaliningrad/frontend/src/components/MapPage.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport { Button, Alert, Card, Badge } from 'react-bootstrap';\nimport { Toilet, ToiletFormData } from '../types';\nimport { toiletAPI } from '../services/api';\nimport L from 'leaflet';\nimport Legend from './Legend';\nimport AddToiletModal from './AddToiletModal';\n\n// Fix for default marker icons\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\n// Оптимизированные иконки с кэшированием\nconst iconCache = new Map<string, L.DivIcon>();\n\nconst createCustomIcon = (type: Toilet['type']): L.DivIcon => {\n  if (iconCache.has(type)) {\n    return iconCache.get(type)!;\n  }\n\n  const iconConfig = {\n    free: { color: '#28a745' },\n    paid: { color: '#dc3545' },\n    purchase_required: { color: '#ffc107' }\n  };\n\n  const config = iconConfig[type];\n  const icon = L.divIcon({\n    html: `<div style=\"background-color: ${config.color}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);\"></div>`,\n    className: 'custom-toilet-marker',\n    iconSize: [20, 20],\n    iconAnchor: [10, 10],\n    popupAnchor: [0, -10]\n  });\n  \n  iconCache.set(type, icon);\n  return icon;\n};\n\n// Kaliningrad center coordinates\nconst KALININGRAD_CENTER = [54.710, 20.511] as [number, number];\n\nconst MapPage: React.FC = () => {\n  const [toilets, setToilets] = useState<Toilet[]>([]);\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [userLocation, setUserLocation] = useState<[number, number] | null>(null);\n  const [locationLoading, setLocationLoading] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [alert, setAlert] = useState<{ show: boolean; message: string; variant: string }>({\n    show: false,\n    message: '',\n    variant: 'success'\n  });\n\n  useEffect(() => {\n    loadToilets();\n    getUserLocation();\n  }, []);\n\n  const getUserLocation = useCallback(() => {\n    if ('geolocation' in navigator) {\n      setLocationLoading(true);\n      \n      // Устанавливаем таймаут для геолокации\n      const timeoutId = setTimeout(() => {\n        setLocationLoading(false);\n        setAlert({\n          show: true,\n          message: 'Не удалось определить местоположение. Проверьте настройки геолокации.',\n          variant: 'warning'\n        });\n      }, 10000); // 10 секунд\n      \n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          clearTimeout(timeoutId);\n          const { latitude, longitude } = position.coords;\n          setUserLocation([latitude, longitude]);\n          setLocationLoading(false);\n        },\n        (error) => {\n          clearTimeout(timeoutId);\n          console.error('Error getting location:', error);\n          setLocationLoading(false);\n          \n          let message = 'Не удалось определить местоположение';\n          switch(error.code) {\n            case error.PERMISSION_DENIED:\n              message = 'Доступ к геолокации запрещен';\n              break;\n            case error.POSITION_UNAVAILABLE:\n              message = 'Информация о местоположении недоступна';\n              break;\n            case error.TIMEOUT:\n              message = 'Время ожидания геолокации истекло';\n              break;\n          }\n          \n          setAlert({\n            show: true,\n            message,\n            variant: 'warning'\n          });\n        },\n        {\n          enableHighAccuracy: true,\n          timeout: 8000,\n          maximumAge: 300000 // 5 минут кэша геолокации\n        }\n      );\n    }\n  }, []);\n\n  const loadToilets = useCallback(async () => {\n    try {\n      const response = await toiletAPI.getAll();\n      // Обрабатываем новый формат ответа с пагинацией\n      const data = Array.isArray(response) ? response : (response as any).data || [];\n      setToilets(data);\n    } catch (error) {\n      console.error('Error loading toilets:', error);\n      setAlert({\n        show: true,\n        message: 'Ошибка загрузки данных',\n        variant: 'danger'\n      });\n    }\n  }, []);\n\n  const handleAddToilet = useCallback(async (data: ToiletFormData) => {\n    setLoading(true);\n    try {\n      await toiletAPI.submit(data);\n      setAlert({\n        show: true,\n        message: 'Точка отправлена на модерацию',\n        variant: 'success'\n      });\n      setShowAddModal(false);\n      // Перезагружаем данные после добавления\n      await loadToilets();\n    } catch (error: any) {\n      setAlert({\n        show: true,\n        message: error.response?.data?.error || 'Ошибка отправки',\n        variant: 'danger'\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [loadToilets]);\n\n\n\n  // Оптимизированные функции с мемоизацией\n  const getTypeLabel = useCallback((type: Toilet['type']) => {\n    const labels = {\n      free: 'Бесплатный',\n      paid: 'Платный',\n      purchase_required: 'Только за покупку'\n    };\n    return labels[type];\n  }, []);\n\n  const getTypeBadgeVariant = useCallback((type: Toilet['type']) => {\n    const variants = {\n      free: 'success',\n      paid: 'danger',\n      purchase_required: 'warning'\n    };\n    return variants[type];\n  }, []);\n\n  // Мемоизированные маркеры для оптимизации рендеринга\n  const toiletMarkers = useMemo(() => {\n    return toilets.map((toilet) => (\n      <Marker \n        key={toilet.id} \n        position={[toilet.latitude, toilet.longitude]}\n        icon={createCustomIcon(toilet.type)}\n      >\n        <Popup>\n          <Card className=\"border-0\" style={{ width: '250px' }}>\n            <Card.Body>\n              <Card.Title className=\"h6\">{toilet.name}</Card.Title>\n              <Card.Text className=\"small text-muted mb-2\">\n                📍 {toilet.address}\n              </Card.Text>\n              <Badge bg={getTypeBadgeVariant(toilet.type)} className=\"mb-2\">\n                {getTypeLabel(toilet.type)}\n              </Badge>\n              {toilet.price && (\n                <div className=\"small mb-2\">\n                  <strong>Стоимость:</strong> {toilet.price}\n                </div>\n              )}\n              {toilet.description && (\n                <div className=\"small text-muted\">\n                  {toilet.description}\n                </div>\n              )}\n            </Card.Body>\n          </Card>\n        </Popup>\n      </Marker>\n    ));\n  }, [toilets, getTypeLabel, getTypeBadgeVariant]);\n\n  // Мемоизированный маркер пользователя\n  const userLocationMarker = useMemo(() => {\n    if (!userLocation) return null;\n    \n    return (\n      <Marker \n        position={userLocation}\n        icon={L.divIcon({\n          html: '<div style=\"background-color: #007bff; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);\"></div>',\n          className: 'user-location-marker',\n          iconSize: [20, 20],\n          iconAnchor: [10, 10],\n          popupAnchor: [0, -10]\n        })}\n      >\n        <Popup>\n          <div className=\"text-center\">\n            <strong>Ваше местоположение</strong>\n          </div>\n        </Popup>\n      </Marker>\n    );\n  }, [userLocation]);\n\n  return (\n    <div className=\"container-fluid p-0\">\n      {alert.show && (\n        <Alert \n          variant={alert.variant} \n          onClose={() => setAlert(prev => ({ ...prev, show: false }))}\n          dismissible\n          className=\"m-3\"\n        >\n          {alert.message}\n        </Alert>\n      )}\n\n      <div className=\"d-flex justify-content-between align-items-center p-3 bg-light\">\n        <h1 className=\"h3 mb-0\">Карта точек</h1>\n        <div>\n          <Button \n            variant=\"outline-secondary\" \n            onClick={getUserLocation}\n            disabled={locationLoading}\n            className=\"me-2\"\n          >\n            {locationLoading ? '📍...' : '📍 Мое местоположение'}\n          </Button>\n          <Button \n            variant=\"primary\" \n            onClick={() => setShowAddModal(true)}\n          >\n            + Добавить точку\n          </Button>\n        </div>\n      </div>\n\n      <Legend userLocationExists={!!userLocation} />\n\n      <div style={{ height: 'calc(100vh - 200px)' }}>\n        <MapContainer \n          center={KALININGRAD_CENTER} \n          zoom={12} \n          style={{ height: '100%', width: '100%' }}\n        >\n          <TileLayer\n            attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n          />\n          \n          {userLocationMarker}\n          {toiletMarkers}\n        </MapContainer>\n      </div>\n\n      <AddToiletModal\n        show={showAddModal}\n        onHide={() => setShowAddModal(false)}\n        onSubmit={handleAddToilet}\n        loading={loading}\n      />\n    </div>\n  );\n};\n\nexport default MapPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}