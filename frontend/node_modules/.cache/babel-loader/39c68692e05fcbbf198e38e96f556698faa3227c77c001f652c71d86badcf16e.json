{"ast":null,"code":"import WebApp from'@twa-dev/sdk';class TelegramService{constructor(){this.isInitialized=false;this.user=null;this.mainButtonCallback=null;this.backButtonCallback=null;}init(){if(typeof window!=='undefined'&&!this.isInitialized){try{var _window$Telegram;// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ð¼Ñ‹ Ð² Telegram WebApp\nif(!((_window$Telegram=window.Telegram)!==null&&_window$Telegram!==void 0&&_window$Telegram.WebApp)){console.warn('Not in Telegram WebApp environment');return;}WebApp.ready();WebApp.expand();// Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ\nif(WebApp.enableClosingConfirmation){WebApp.enableClosingConfirmation();}// Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ñ‚ÐµÐ¼Ñƒ\nif(WebApp.colorScheme){document.documentElement.setAttribute('data-theme',WebApp.colorScheme);}// ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ñ†Ð²ÐµÑ‚Ð¾Ð²ÑƒÑŽ ÑÑ…ÐµÐ¼Ñƒ Telegram\nthis.applyTelegramTheme();// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ\nif(WebApp.initDataUnsafe.user){this.user=WebApp.initDataUnsafe.user;}// ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÐºÐ½Ð¾Ð¿ÐºÐ¸ \"ÐÐ°Ð·Ð°Ð´\"\nif(WebApp.BackButton&&WebApp.BackButton.onClick){WebApp.BackButton.onClick(()=>{if(this.backButtonCallback){this.backButtonCallback();}else{window.history.back();}});}// ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð½Ð¾Ð¹ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹\nif(WebApp.MainButton&&WebApp.MainButton.setParams){var _WebApp$themeParams,_WebApp$themeParams2;WebApp.MainButton.setParams({text:'ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ',color:((_WebApp$themeParams=WebApp.themeParams)===null||_WebApp$themeParams===void 0?void 0:_WebApp$themeParams.button_color)||'#007bff',text_color:((_WebApp$themeParams2=WebApp.themeParams)===null||_WebApp$themeParams2===void 0?void 0:_WebApp$themeParams2.button_text_color)||'#ffffff'});// Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ\nif(WebApp.MainButton.onClick){WebApp.MainButton.onClick(()=>{if(this.mainButtonCallback){this.mainButtonCallback();}else{WebApp.MainButton.hide();}});}}// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÑƒ Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸ Ð² Telegram\nthis.checkGeolocationSupport();// ÐÐ´Ð°Ð¿Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ viewport Ð´Ð»Ñ Telegram\nthis.adaptViewport();this.isInitialized=true;console.log('Telegram WebApp initialized successfully');}catch(error){console.error('Failed to initialize Telegram WebApp:',error);}}}checkGeolocationSupport(){// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð»Ð¸ Telegram WebApp Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸ÑŽ\nif(navigator.geolocation){console.log('Geolocation is supported in this Telegram WebApp');// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ HTTPS\nif(location.protocol==='https:'||location.hostname==='localhost'){console.log('Secure context detected - geolocation should work');}else{console.warn('Insecure context - geolocation may not work');}}else{console.warn('Geolocation is not supported in this Telegram WebApp');}}applyTelegramTheme(){if(!this.isInitialized||!WebApp.themeParams)return;const themeParams=WebApp.themeParams;const root=document.documentElement;// ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ñ†Ð²ÐµÑ‚Ð° Ð¸Ð· Telegram\nif(themeParams.bg_color){root.style.setProperty('--tg-bg-color',themeParams.bg_color);document.body.style.backgroundColor=themeParams.bg_color;}if(themeParams.text_color){root.style.setProperty('--tg-text-color',themeParams.text_color);document.body.style.color=themeParams.text_color;}if(themeParams.hint_color){root.style.setProperty('--tg-hint-color',themeParams.hint_color);}if(themeParams.button_color){root.style.setProperty('--tg-button-color',themeParams.button_color);}if(themeParams.button_text_color){root.style.setProperty('--tg-button-text-color',themeParams.button_text_color);}// Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ data-theme Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚ Ð´Ð»Ñ CSS\nconst colorScheme=WebApp.colorScheme||'light';root.setAttribute('data-theme',colorScheme);if(colorScheme==='dark'){root.classList.add('dark-theme');}else{root.classList.remove('dark-theme');}}adaptViewport(){if(!this.isInitialized)return;// ÐÐ´Ð°Ð¿Ñ‚Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð² Ð² Telegram\ndocument.body.style.margin='0';document.body.style.padding='0';document.body.style.height='100vh';document.body.style.overflow='hidden';document.body.style.position='fixed';document.body.style.top='0';document.body.style.left='0';document.body.style.right='0';document.body.style.bottom='0';// ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ viewport\nif(WebApp.onEvent){WebApp.onEvent('viewportChanged',()=>{const height=WebApp.viewportHeight;document.documentElement.style.setProperty('--tg-viewport-height',\"\".concat(height,\"px\"));});}}getUser(){return this.user;}isTelegramApp(){var _window$Telegram2;return typeof window!=='undefined'&&((_window$Telegram2=window.Telegram)===null||_window$Telegram2===void 0?void 0:_window$Telegram2.WebApp)!==undefined;}// Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ¾Ð¹\nshowMainButton(){if(this.isInitialized&&WebApp.MainButton&&WebApp.MainButton.show){WebApp.MainButton.show();}}hideMainButton(){if(this.isInitialized&&WebApp.MainButton&&WebApp.MainButton.hide){WebApp.MainButton.hide();}}setMainButtonParams(params){if(this.isInitialized&&WebApp.MainButton&&WebApp.MainButton.setParams){WebApp.MainButton.setParams(params);}}setMainButtonCallback(callback){this.mainButtonCallback=callback;}clearMainButtonCallback(){this.mainButtonCallback=null;}// Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ½Ð¾Ð¿ÐºÐºÐ¾Ð¹ \"ÐÐ°Ð·Ð°Ð´\"\nshowBackButton(){if(this.isInitialized&&WebApp.BackButton&&WebApp.BackButton.show){WebApp.BackButton.show();}}hideBackButton(){if(this.isInitialized&&WebApp.BackButton&&WebApp.BackButton.hide){WebApp.BackButton.hide();}}setBackButtonCallback(callback){this.backButtonCallback=callback;}clearBackButtonCallback(){this.backButtonCallback=null;}// Ð’ÑÐ¿Ð»Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ðµ Ð¾ÐºÐ½Ð°\nshowAlert(message){if(this.isInitialized&&this.isTelegramApp()&&WebApp.showAlert){try{WebApp.showAlert(message);}catch(error){console.warn('WebApp.showAlert not supported, fallback to alert:',error);alert(message);}}else{alert(message);}}showConfirm(message,callback){if(this.isInitialized&&this.isTelegramApp()&&WebApp.showConfirm){try{WebApp.showConfirm(message,callback);}catch(error){console.warn('WebApp.showConfirm not supported, fallback to confirm:',error);const confirmed=window.confirm(message);if(callback)callback(confirmed);}}else{const confirmed=window.confirm(message);if(callback)callback(confirmed);}}// ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ ÑÑÑ‹Ð»Ð¾Ðº\nopenLink(url){if(this.isInitialized&&WebApp.openLink){WebApp.openLink(url);}else{window.open(url,'_blank');}}openTelegramLink(url){if(this.isInitialized&&WebApp.openTelegramLink){WebApp.openTelegramLink(url);}else{window.open(url,'_blank');}}// Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼\nclose(){if(this.isInitialized&&WebApp.close){WebApp.close();}}ready(){if(this.isInitialized&&WebApp.ready){WebApp.ready();}}expand(){if(this.isInitialized&&WebApp.expand){WebApp.expand();}}// Ð¢ÐµÐ¼Ð° Ð¸ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ\ngetThemeParams(){if(this.isInitialized){return WebApp.themeParams;}return{};}getColorScheme(){if(this.isInitialized){return WebApp.colorScheme;}return'light';}getViewportHeight(){if(this.isInitialized){return WebApp.viewportHeight;}return window.innerHeight;}// Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ\nsendData(data){if(this.isInitialized&&WebApp.sendData){WebApp.sendData(data);}}openInvoice(url,callback){if(this.isInitialized&&WebApp.openInvoice){WebApp.openInvoice(url,callback);}}setHeaderColor(color){if(this.isInitialized&&WebApp.setHeaderColor){WebApp.setHeaderColor(color);}}setBackgroundColor(color){if(this.isInitialized&&WebApp.setBackgroundColor){WebApp.setBackgroundColor(color);}}// Haptic feedback\nimpactOccurred(){let style=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'medium';if(this.isInitialized&&this.isTelegramApp()&&WebApp.HapticFeedback){WebApp.HapticFeedback.impactOccurred(style);}}notificationOccurred(type){if(this.isInitialized&&this.isTelegramApp()&&WebApp.HapticFeedback){WebApp.HapticFeedback.notificationOccurred(type);}}selectionChanged(){if(this.isInitialized&&this.isTelegramApp()&&WebApp.HapticFeedback){WebApp.HapticFeedback.selectionChanged();}}// ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ initData Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€\ngetInitData(){if(this.isInitialized){return WebApp.initData;}return null;}// Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¼ÐµÑ‚Ð¾Ð´ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸ Ð² Telegram WebApp\nrequestGeolocation(){return new Promise((resolve,reject)=>{if(!navigator.geolocation){reject(new Error('Ð“ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ñ Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ'));return;}const options={enableHighAccuracy:true,timeout:30000,maximumAge:600000};navigator.geolocation.getCurrentPosition(resolve,reject,options);});}// ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸\nisGeolocationAvailable(){return!!navigator.geolocation;}// ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸\nshowGeolocationButton(callback){if(this.isInitialized&&WebApp.MainButton){this.setMainButtonParams({text:'ðŸ“ ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ Ð¼ÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ',color:'#007bff'});this.setMainButtonCallback(()=>{callback();// Ð¡ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð¿Ð¾ÑÐ»Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ\nsetTimeout(()=>{this.hideMainButton();},2000);});this.showMainButton();}}// ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð³ÐµÐ¾Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸\nshowRetryGeolocationButton(callback){if(this.isInitialized&&WebApp.MainButton){this.setMainButtonParams({text:'ðŸ”„ ÐŸÐ¾Ð¿Ñ€Ð¾Ð±Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ½Ð¾Ð²Ð°',color:'#dc3545'});this.setMainButtonCallback(()=>{callback();});this.showMainButton();}}}export const telegramService=new TelegramService();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}